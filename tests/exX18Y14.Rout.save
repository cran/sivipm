
R version 3.2.0 (2015-04-16) -- "Full of Ingredients"
Copyright (C) 2015 The R Foundation for Statistical Computing
Platform: x86_64-unknown-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> # Example ex18Y14: the same 18 inputs as in X18Y2 but with 14 responses
> library("sivipm")
Loading required package: seqinr
Loading required package: ade4
> 
> # -------------------------------------
> # READ DATA 
> 
> # X18Y14 <-read.table("../inst/extdata/X18Y14.txt", header=TRUE, na.strings =".", colClasses  = "numeric" )
> 
> X18Y14 <-read.table(system.file("extdata", "X18Y14.txt", package="sivipm"),  header=TRUE, na.strings =".", colClasses  = "numeric" )
> 
> datancol <- ncol(X18Y14)
> nX=18
> X = X18Y14[,1:nX]
> Y = X18Y14[,(nX+1):datancol]
> # -------------------------------------
> # CALCULATIONS WITH POLYNOME DESCRIPTION NOT REQUIRED
> nc=2
> b <- new("polyX", dataX.exp=X)
> A <-  sivipm(Y, b, nc=nc)
Warning message:
In sivipm(Y, b, nc = nc) :
  sivipm : option tsivip ignored because there is no polynomial description
> print( A)
fo.isivip 
         V1          V2          V3          V4          V5          V6 
0.004792694 0.032170481 0.009610074 0.034355202 0.008538489 0.003896552 
         V7          V8          V9         V10         V11         V12 
0.011293923 0.003139617 0.011171663 0.059926529 0.070243988 0.015072844 
        V13         V14         V15         V16         V17         V18 
0.370753498 0.019664093 0.082385433 0.035343384 0.178526426 0.049115109 

simca.signifcomponents 
    V19   V20   V21   V22   V23   V24   V25   V26   V27   V28   V29   V30  V31
c1 TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE TRUE
c2 TRUE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE FALSE TRUE
     V32   Q2T
c1  TRUE  TRUE
c2 FALSE FALSE

lazraq.signifcomponents 
  c1   c2 
TRUE TRUE 

> 
> # -------------------------------------
> #  MONOME DESCRIPTION: monomes coded by the inputs numbers
> Pexp <- as.character(1:18)
> for (i in 1:13) {
+   Pexp <- c(Pexp, paste(i,"*",i, sep=""))
+ }
> for (i in 1:13) {
+   Pexp <- c(Pexp, paste(i,"*",i, "*",i, sep=""))
+ }
> for (i in 1:12) {
+   for (j in (i+1):13) {
+      Pexp <-  c(Pexp, paste(i,"*",j, sep=""))
+    }
+ }
> for (i in 1:18) {
+     if (i != 15)
+     Pexp <- c(Pexp, paste("15*",i,sep=""))
+   }
> for (i in 16:18) {
+     for (j in 9:11) {
+       Pexp <- c(Pexp, paste(i, "*", j,sep=""))
+    }
+ }
> Pexp <- c(Pexp, c("13*16"), c("13*17"), c("13*18"),
+              c("14*16"), c("14*17"), c("14*18"),
+             c("14*9"), c("14*10"), c("12*14"), c("2*14"))
> 
> 
> 
> zz <- vect2polyX(X, Pexp)
> 
> # -------------------------------------
> # CALCULATIONS
> res1 <- sivipm(Y[,1], zz,nc)
> print(res1)
fo.isivip 
          V1           V2           V3           V4           V5           V6 
0.0016870719 0.0023960921 0.0024994435 0.0049649430 0.0010976140 0.0002561018 
          V7           V8           V9          V10          V11          V12 
0.0012989655 0.0011880996 0.0010924755 0.0130095173 0.0109610311 0.0030012959 
         V13          V14          V15          V16          V17          V18 
0.0341644105 0.0021995356 0.0081556112 0.0041859590 0.0223305564 0.0059387660 

tsivip 
        V1         V2         V3         V4         V5         V6         V7 
0.08987754 0.07157970 0.09358609 0.07956209 0.02063671 0.08526170 0.01890856 
        V8         V9        V10        V11        V12        V13        V14 
0.08554924 0.11966218 0.22244490 0.16914174 0.07104748 0.35179338 0.02216862 
       V15        V16        V17        V18 
0.10130698 0.02529825 0.11673339 0.02819176 

percentage 
      V13       V10       V11        V9       V17       V15        V3        V1 
19.844497 12.548011  9.541205  6.750087  6.584875  5.714678  5.279147  5.069949 
       V8        V6        V4        V2       V12       V18       V16       V14 
 4.825792  4.809572  4.488059  4.037777  4.007754  1.590284  1.427062  1.250521 
       V5        V7 
 1.164107  1.066623 

simca.signifcomponents 
      Y1   Q2T
c1  TRUE  TRUE
c2 FALSE FALSE

lazraq.signifcomponents 
  c1   c2 
TRUE TRUE 

> 
> proc.time()
   user  system elapsed 
  1.357   0.116   1.464 
